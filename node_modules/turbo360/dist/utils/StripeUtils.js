var Promise=require("bluebird"),StripeUtils=function(){return{createStripeAccount:function(r){return new Promise(function(e,i){return null==r.stripeRef?void i(new Error("Missing stripeRef")):null==r.client?void i(new Error("Missing Client Parameter")):null==r.stripeToken?void i(new Error("Missing StripeToken Parameter")):void r.stripeRef.customers.create({description:r.client._id.toString(),source:r.stripeToken},function(n,t){if(n)return void i(n);var o=t.sources.data[0];r.client.stripeId=t.id,r.client.creditCard={id:t.id,lastFour:o.last4,exp_month:o.exp_month,exp_year:o.exp_year,brand:o.brand},e(r.client)})})},createStripeCharge:function(r){return new Promise(function(e,i){return null==r.stripeRef?void i(new Error("Missing stripeRef")):null==r.amount?void i(new Error("Missing Amount Parameter")):null==r.stripeToken?void i(new Error("Missing StripeToken Parameter")):null==r.description?void i(new Error("Missing Description Parameter")):void r.stripeRef.charges.create({amount:100*r.amount,currency:"usd",source:r.stripeToken,description:r.description},function(r,n){if(r)return void i(r);e(n)})})},recurringCharge:function(r){return new Promise(function(e,i){return null==r.stripeRef?void i(new Error("Missing stripeRef")):null==r.amount?void i(new Error("Missing amount parameter")):null==r.customerId?void i(new Error("Missing customerId parameter")):null==r.description?void i(new Error("Missing description parameter")):void r.stripeRef.charges.create({amount:100*r.amount,currency:"usd",customer:r.customerId,description:r.description},function(r,n){if(r)return void i(r);e(n)})})}}};module.exports=StripeUtils;